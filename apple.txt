this is from apple branch 
